(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{NrAR:function(e,a,t){"use strict";t.r(a),t.d(a,"_frontmatter",(function(){return s})),t.d(a,"default",(function(){return o}));t("rzGZ"),t("Dq+y"),t("8npG"),t("Ggvi"),t("E5k/"),t("q1tI");var n=t("7ljp");var s={path:"/How-Do-Machines-Actually-Learn",date:"2021-02-10T15:44:31.723Z",title:"How Do Machines Actually Learn",featuredImage:"./2.jpg",headerImage:"./1.jpg",tags:["machine learning","deep learning","artificial intelligence","python","numpy"],excerpt:"How do machines actually learn? Introduction to gradient descent."},c={_frontmatter:s};function o(e){var a=e.components,t=function(e,a){if(null==e)return{};var t,n,s={},c=Object.keys(e);for(n=0;n<c.length;n++)t=c[n],a.indexOf(t)>=0||(s[t]=e[t]);return s}(e,["components"]);return Object(n.mdx)("wrapper",Object.assign({},c,t,{components:a,mdxType:"MDXLayout"}),Object(n.mdx)("p",null,"From the previous blogs, we know basically how a machine will make predictions. So obviously, the next question is how will a machine improve the prediction it\nmakes, how will the prediction be more accurate? This is where we will understand how a machine learns, or in a more technical way, how the algorithm will update\nthe weights to give a better output. "),Object(n.mdx)("p",null,"In a previous blog, I mentioned the three basic steps of how machine learning works are predicting, comparing and learning. Let‚Äôs dive into the comparing and\nlearning parts now. "),Object(n.mdx)("h2",null,"üìä Comparing"),Object(n.mdx)("p",null,"After predicting an output, we need to measure how close the output was to the correct answer. Only once we know by how much did our measurement miss, will we\nbe able to ‚Äúlearn‚Äù where we went wrong. "),Object(n.mdx)("p",null,"For this, we find out the error between the prediction and the true output. The simplest way to find this error is to subtract the input from the output and see\nby what margin we were off. "),Object(n.mdx)("h2",null,"üìà Learning"),Object(n.mdx)("p",null,"After comparison, the final step is learning which updates the  weights in a network to make better predictions. In this  blog, we will consider a learning\nalgorithm called Gradient Descent."),Object(n.mdx)("h2",null,"üéØ Finding the error"),Object(n.mdx)("div",{className:"gatsby-highlight","data-language":"python"},Object(n.mdx)("pre",Object.assign({parentName:"div"},{className:"language-python"}),Object(n.mdx)("code",Object.assign({parentName:"pre"},{className:"language-python"}),"weight ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token number"}),"0.5"),"\n",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token builtin"}),"input")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token number"}),"0.3"),"\ngoal ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token number"}),"1"),"\n\npred ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token builtin"}),"input")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"*")," weight\n\nerror ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"goal ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"-")," pred",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"**")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token number"}),"2"),"\n",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"print"),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"error",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")")))),Object(n.mdx)("p",null,"Output: "),Object(n.mdx)("div",{className:"gatsby-highlight","data-language":"text"},Object(n.mdx)("pre",Object.assign({parentName:"div"},{className:"language-text"}),Object(n.mdx)("code",Object.assign({parentName:"pre"},{className:"language-text"}),"0.7224999999999999"))),Object(n.mdx)("p",null,"Here we calculated the difference between the prediction made and the goal, and then squared it. This is called the mean squared error. This is one of the\ntechniques using which we can find the error. There‚Äôll be a couple of questions coming up about now."),Object(n.mdx)("p",null,Object(n.mdx)("strong",{parentName:"p"},"Why did we square the error?")),Object(n.mdx)("p",null,"We want the error to be positive, and hence we square it. Simply finding the difference between ",Object(n.mdx)("code",Object.assign({parentName:"p"},{className:"language-text"}),"goal")," and ",Object(n.mdx)("code",Object.assign({parentName:"p"},{className:"language-text"}),"pred")," might sometimes give a negative result."),Object(n.mdx)("p",null,Object(n.mdx)("strong",{parentName:"p"},"Why do we need the error to be positive?")),Object(n.mdx)("p",null,"Let‚Äôs say you‚Äôre practising target shooting. Whether your bullet hits the target 2 centimetres above, or 2 centimetres below, both the times, you missed by 2\ncentimetres. In both the cases your error is 2 centimetres. Now instead of squaring if you just find the error, the error will be 2 centimetres, and -2\ncentimeters, thereby making the resultant average of the error 0(",Object(n.mdx)("code",Object.assign({parentName:"p"},{className:"language-text"}),"2 + (-2) = 0"),"). This will give us a wrong result. Therefore to include the entire range, we\nkeep the error positive by squaring it. "),Object(n.mdx)("p",null,"One thing to note here is: Squaring will make big errors bigger, and small errors, -1 < error < 1, smaller. But this works fine because we will be able to\npenalise bigger errors better, instead of worrying about the small ones. "),Object(n.mdx)("h2",null,"üìâ Gradient descent"),Object(n.mdx)("p",null,"So now let‚Äôs get into gradient descent. Imagine you are in a valley. You need to get to the bottom of the valley by taking small steps at a time. If your steps\nare too large, you‚Äôll end up crossing the bottom, and if your steps are too small it‚Äôll take you forever to get to the bottom. The algorithm which will help you\nget to the bottom efficiently is gradient descent. "),Object(n.mdx)("p",null,Object(n.mdx)("span",Object.assign({parentName:"p"},{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1174px"}}),"\n      ",Object(n.mdx)("a",Object.assign({parentName:"span"},{className:"gatsby-resp-image-link",href:"/blog/static/9b0e1d17b2e6fa5c1655be510303d25f/04784/gd.png",style:{display:"block"},target:"_blank",rel:["noopener"]}),"\n    ",Object(n.mdx)("span",Object.assign({parentName:"a"},{className:"gatsby-resp-image-background-image",style:{paddingBottom:"87.74703557312253%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAIAAADUsmlHAAAACXBIWXMAAB2HAAAdhwGP5fFlAAABMklEQVQ4y52TaW6EMAyFuf9N+M8lOAFBQiAIy5R936F9rSkwlDJoLIGCyBfb7znCPM9933++FcI4jkVR3AeQbIN932+a5iaJTNi/HiEEQZBl2X3YcZwNruvadd1DPf9FVVVRFG1wnue2bb+E6W8YhiTQAmuaZlnWm7BhGOCHYbijs+d50zRtakMwZEYzL2GMw0EdAU8cxzjyovK1ZvJlg1EGPmRZvuYRMAlWPU0YdSuKoiRJ5ORpWuTcj8cC46PrOqxM02zb9jQ5ToSdf8/9LhsBMbhlcc6J3L8R6Oh0ChfBdF0vyzJNU5tzamTlQWLD+a0iGZmiBL6PwpAB+WG+qqpoBOskSejaDj8BU1erhX0SwLT+eDxUxtAneQFm/A3o8uTzQSTswNgoisIYa5v2Ymy+ANkhHqSmdsUiAAAAAElFTkSuQmCC')",backgroundSize:"cover",display:"block"}})),"\n  ",Object(n.mdx)("picture",{parentName:"a"},"\n        ",Object(n.mdx)("source",Object.assign({parentName:"picture"},{srcSet:["/blog/static/9b0e1d17b2e6fa5c1655be510303d25f/6b97b/gd.webp 506w","/blog/static/9b0e1d17b2e6fa5c1655be510303d25f/2dbb9/gd.webp 1012w","/blog/static/9b0e1d17b2e6fa5c1655be510303d25f/963af/gd.webp 1174w"],sizes:"(max-width: 1174px) 100vw, 1174px",type:"image/webp"})),"\n        ",Object(n.mdx)("source",Object.assign({parentName:"picture"},{srcSet:["/blog/static/9b0e1d17b2e6fa5c1655be510303d25f/29f4e/gd.png 506w","/blog/static/9b0e1d17b2e6fa5c1655be510303d25f/ad997/gd.png 1012w","/blog/static/9b0e1d17b2e6fa5c1655be510303d25f/04784/gd.png 1174w"],sizes:"(max-width: 1174px) 100vw, 1174px",type:"image/png"})),"\n        ",Object(n.mdx)("img",Object.assign({parentName:"picture"},{className:"gatsby-resp-image-image",src:"/blog/static/9b0e1d17b2e6fa5c1655be510303d25f/04784/gd.png",alt:"gd",title:"gd",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"}})),"\n      "),"\n  "),"\n    ")),Object(n.mdx)("p",null,"We are currently at the black dot, and we want to get to the dotted circle, which is the bottom.   "),Object(n.mdx)("p",null,"The basic rule of machine learning: We need to keep adjusting the weights so that the error reduces to 0."),Object(n.mdx)("p",null,"Let‚Äôs see the code for a basic implementation of gradient descent: "),Object(n.mdx)("div",{className:"gatsby-highlight","data-language":"python"},Object(n.mdx)("pre",Object.assign({parentName:"div"},{className:"language-python"}),Object(n.mdx)("code",Object.assign({parentName:"pre"},{className:"language-python"}),"weight",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," goal_pred",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token builtin"}),"input")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token number"}),"0.0"),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token number"}),"0.5"),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token number"}),"1.1"),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),"\n\n",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"for")," iteration ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"in")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token builtin"}),"range"),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token number"}),"4"),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),":"),"\n\t",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"print"),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token string"}),'"-----\\nWeight:"')," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"+")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token builtin"}),"str"),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"weight",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),"\n\tpred ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token builtin"}),"input")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"*")," weight\n\terror ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"pred ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"-")," goal_pred",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"**")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token number"}),"2"),"\n\tdelta ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," pred ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"-")," goal_pred\n\tweight_delta ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," delta ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"*")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token builtin"}),"input"),"\n\tweight ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," weight ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"-")," weight_delta\n\t",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"print"),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token string"}),'"Error:"')," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"+")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token builtin"}),"str"),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"error",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"+")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token string"}),'" Prediction:"')," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"+")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token builtin"}),"str"),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"pred",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),"\n\t",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"print"),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token string"}),'"Delta:"')," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"+")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token builtin"}),"str"),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"delta",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"+")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token string"}),'" Weight Delta:"')," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"+")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token builtin"}),"str"),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"weight_delta",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")")))),Object(n.mdx)("p",null,"Output: "),Object(n.mdx)("div",{className:"gatsby-highlight","data-language":"text"},Object(n.mdx)("pre",Object.assign({parentName:"div"},{className:"language-text"}),Object(n.mdx)("code",Object.assign({parentName:"pre"},{className:"language-text"}),"-----\nWeight:0.0\nError:0.25 Prediction:0.0\nDelta:-0.5 Weight Delta:-0.55\n-----\nWeight:0.55\nError:0.01102500000000002 Prediction:0.6050000000000001\nDelta:0.1050000000000001 Weight Delta:0.11550000000000012\n-----\nWeight:0.43449999999999994\nError:0.00048620250000000064 Prediction:0.47795\nDelta:-0.022050000000000014 Weight Delta:-0.024255000000000016\n-----\nWeight:0.45875499999999997\nError:2.1441530249999833e-05 Prediction:0.5046305\nDelta:0.004630499999999982 Weight Delta:0.0050935499999999806"))),Object(n.mdx)("p",null,Object(n.mdx)("strong",{parentName:"p"},"What does each variable do here?")),Object(n.mdx)("table",null,Object(n.mdx)("thead",{parentName:"table"},Object(n.mdx)("tr",{parentName:"thead"},Object(n.mdx)("th",Object.assign({parentName:"tr"},{align:null}),"pred"),Object(n.mdx)("th",Object.assign({parentName:"tr"},{align:null}),"The prediction made by the network"))),Object(n.mdx)("tbody",{parentName:"table"},Object(n.mdx)("tr",{parentName:"tbody"},Object(n.mdx)("td",Object.assign({parentName:"tr"},{align:null}),"error"),Object(n.mdx)("td",Object.assign({parentName:"tr"},{align:null}),"The mean squared error")),Object(n.mdx)("tr",{parentName:"tbody"},Object(n.mdx)("td",Object.assign({parentName:"tr"},{align:null}),"delta"),Object(n.mdx)("td",Object.assign({parentName:"tr"},{align:null}),"The absolute error with it‚Äôs sign")),Object(n.mdx)("tr",{parentName:"tbody"},Object(n.mdx)("td",Object.assign({parentName:"tr"},{align:null}),"weight_delta"),Object(n.mdx)("td",Object.assign({parentName:"tr"},{align:null}),"Calculating the amount by which the weights need to be changed along with the direction (positive or negative, increase or decrease)")))),Object(n.mdx)("p",null,"Here we calculated the ",Object(n.mdx)("code",Object.assign({parentName:"p"},{className:"language-text"}),"weight_delta")," by multiplying the delta with the input. The reason for this is so that the change to be made in the weights can be scaled.\nBasically, if the input is big, the amount by which we change the weight should also be big."),Object(n.mdx)("p",null,"This is the simplest implementation of gradient descent in which we: "),Object(n.mdx)("ul",null,Object(n.mdx)("li",{parentName:"ul"},"Find the prediction"),Object(n.mdx)("li",{parentName:"ul"},"Find the mean squared error"),Object(n.mdx)("li",{parentName:"ul"},"Find the absolute error"),Object(n.mdx)("li",{parentName:"ul"},"Find the amount by which the weight needs to be updates"),Object(n.mdx)("li",{parentName:"ul"},"Update the weight")),Object(n.mdx)("p",null,"As we keep improving the algorithm, the underlying steps will still follow the same principles. "),Object(n.mdx)("p",null,"Let‚Äôs dig deeper into ",Object(n.mdx)("code",Object.assign({parentName:"p"},{className:"language-text"}),"weight_delta")," before we proceed further. ",Object(n.mdx)("code",Object.assign({parentName:"p"},{className:"language-text"}),"weight_delta")," is a derivative. A derivative simply allows us to pick a couple of variables in a\nformula and figure out how they relate to each other. Here, ",Object(n.mdx)("code",Object.assign({parentName:"p"},{className:"language-text"}),"weight_delta")," is what is determining the relation between the ",Object(n.mdx)("code",Object.assign({parentName:"p"},{className:"language-text"}),"error")," and the ",Object(n.mdx)("code",Object.assign({parentName:"p"},{className:"language-text"}),"weight"),". Our\nderivative, ",Object(n.mdx)("code",Object.assign({parentName:"p"},{className:"language-text"}),"weight_delta")," tells how much did changing a weight contribute to the error. "),Object(n.mdx)("table",null,Object(n.mdx)("thead",{parentName:"table"},Object(n.mdx)("tr",{parentName:"thead"},Object(n.mdx)("th",Object.assign({parentName:"tr"},{align:null}),Object(n.mdx)("img",Object.assign({parentName:"th"},{src:"https://user-images.githubusercontent.com/41234408/107554978-a343eb00-6bfc-11eb-97f5-1a3669ca8154.gif",alt:"gd2"}))))),Object(n.mdx)("tbody",{parentName:"table"},Object(n.mdx)("tr",{parentName:"tbody"},Object(n.mdx)("td",Object.assign({parentName:"tr"},{align:null}),"How gradient descent reaches the bottom")))),Object(n.mdx)("p",null,"Now, in the algorithm we ran, try to set the ",Object(n.mdx)("code",Object.assign({parentName:"p"},{className:"language-text"}),"goal_pred")," variable to 4."),Object(n.mdx)("p",null,"Output: "),Object(n.mdx)("div",{className:"gatsby-highlight","data-language":"text"},Object(n.mdx)("pre",Object.assign({parentName:"div"},{className:"language-text"}),Object(n.mdx)("code",Object.assign({parentName:"pre"},{className:"language-text"}),"-----\nWeight:0.0\nError:0.25 Prediction:0.0\nDelta:-0.5 Weight Delta:-2.0\n-----\nWeight:2.0\nError:56.25 Prediction:8.0\nDelta:7.5 Weight Delta:30.0\n-----\nWeight:-28.0\nError:12656.25 Prediction:-112.0\nDelta:-112.5 Weight Delta:-450.0\n-----\nWeight:422.0\nError:2847656.25 Prediction:1688.0\nDelta:1687.5 Weight Delta:6750.0"))),Object(n.mdx)("p",null,"The output is not even remotely close to 2, and the error just kept on increasing. The reason for this is they way we are updating the weights. "),Object(n.mdx)("p",null,Object(n.mdx)("code",Object.assign({parentName:"p"},{className:"language-text"}),"weight = weight - (input * (pred - goal_pred))")),Object(n.mdx)("p",null,"The larger, the input, the larger the update to the weight. The network will start overcorrecting in both directions in order to compensate for the error. "),Object(n.mdx)("p",null,"Imagine you‚Äôre blindfolded and are jumping down a mountain in small jumps to get to the bottom. So you keep taking small jumps. In case of this current\nscenario, let‚Äôs assume you miss the bottom, and jump up to the other side which starts going up. You know now that you‚Äôve crossed the bottom since you‚Äôre going\nfurther away from your goal. So now in order to take a step back, you jump in the reverse direction. But since your input is already big, it‚Äôll result in your\njump taking you back up to the other side of the mountain. This will keep continuing, the error increasing, and you going further away from the bottom."),Object(n.mdx)("p",null,"This is known as divergence. "),Object(n.mdx)("h2",null,"ü§º‚Äç‚ôÇÔ∏è How to combat divergence?"),Object(n.mdx)("p",null,"Now that we know where our algorithm lacks, we need to improve it. The error is basically that the network is overshooting. What if we could simply multiply the\nweight update by a small number which compensates for this overshooting? This way, we would be taking smaller steps instead of jumping here and there."),Object(n.mdx)("p",null,"For this purpose, we use a variable called alpha. The alpha value generally ranges between 0 and 1. ",Object(n.mdx)("code",Object.assign({parentName:"p"},{className:"language-text"}),"alpha")," is something which we need to find out, mostly by\nguesswork(there are more elegant solutions to this than guesswork which we can get to later). We can try out different values of alpha ranging between 0 and 1,\nlike 0.1, 0.01, 0.001, etc, and keep on adjusting it until we feel the value is optimal and there won‚Äôt be any major overshooting. "),Object(n.mdx)("p",null,"So we will simply multiply our derivative with alpha. Let‚Äôs take a look at the updated code which includes ",Object(n.mdx)("code",Object.assign({parentName:"p"},{className:"language-text"}),"alpha")," as well."),Object(n.mdx)("div",{className:"gatsby-highlight","data-language":"python"},Object(n.mdx)("pre",Object.assign({parentName:"div"},{className:"language-python"}),Object(n.mdx)("code",Object.assign({parentName:"pre"},{className:"language-python"}),"weight",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," goal_pred",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token builtin"}),"input")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token number"}),"0.0"),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token number"}),"0.5"),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token number"}),"4"),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),"\nalpha ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token number"}),"0.1"),"\n\n",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"for")," iteration ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"in")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token builtin"}),"range"),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token number"}),"4"),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),":"),"\n\t",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"print"),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token string"}),'"-----\\nWeight:"')," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"+")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token builtin"}),"str"),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"weight",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),"\n\tpred ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token builtin"}),"input")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"*")," weight\n\terror ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"pred ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"-")," goal_pred",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"**")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token number"}),"2"),"\n\tdelta ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," pred ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"-")," goal_pred\n\tweight_delta ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," delta ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"*")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token builtin"}),"input"),"\n\tweight ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," weight ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"-")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"alpha ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"*")," weight_delta",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),"\n\t",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"print"),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token string"}),'"Error:"')," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"+")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token builtin"}),"str"),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"error",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"+")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token string"}),'" Prediction:"')," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"+")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token builtin"}),"str"),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"pred",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),"\n\t",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"print"),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token string"}),'"Delta:"')," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"+")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token builtin"}),"str"),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"delta",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"+")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token string"}),'" Weight Delta:"')," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"+")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token builtin"}),"str"),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"weight_delta",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),"\n"))),Object(n.mdx)("p",null,"Output: "),Object(n.mdx)("div",{className:"gatsby-highlight","data-language":"text"},Object(n.mdx)("pre",Object.assign({parentName:"div"},{className:"language-text"}),Object(n.mdx)("code",Object.assign({parentName:"pre"},{className:"language-text"}),"-----\nWeight:0.0\nError:0.25 Prediction:0.0\nDelta:-0.5 Weight Delta:-2.0\n-----\nWeight:0.2\nError:0.09000000000000002 Prediction:0.8\nDelta:0.30000000000000004 Weight Delta:1.2000000000000002\n-----\nWeight:0.07999999999999999\nError:0.03240000000000002 Prediction:0.31999999999999995\nDelta:-0.18000000000000005 Weight Delta:-0.7200000000000002\n-----\nWeight:0.15200000000000002\nError:0.011664000000000022 Prediction:0.6080000000000001\nDelta:0.1080000000000001 Weight Delta:0.4320000000000004"))),Object(n.mdx)("p",null,"The output is now a lot closer to 0.5, than what it was before. This means we‚Äôre on the correct track. Now we can just increase the number of iterations from 4\nto 20 in order to get the desired result. "),Object(n.mdx)("div",{className:"gatsby-highlight","data-language":"python"},Object(n.mdx)("pre",Object.assign({parentName:"div"},{className:"language-python"}),Object(n.mdx)("code",Object.assign({parentName:"pre"},{className:"language-python"}),"weight",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," goal_pred",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token builtin"}),"input")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token number"}),"0.0"),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token number"}),"0.5"),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),",")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token number"}),"4"),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),"\nalpha ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token number"}),"0.1"),"\n\n",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"for")," iteration ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"in")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token builtin"}),"range"),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token number"}),"20"),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),":"),"\n\t",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"print"),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token string"}),'"-----\\nWeight:"')," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"+")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token builtin"}),"str"),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"weight",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),"\n\tpred ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token builtin"}),"input")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"*")," weight\n\terror ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"pred ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"-")," goal_pred",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"**")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token number"}),"2"),"\n\tdelta ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," pred ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"-")," goal_pred\n\tweight_delta ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," delta ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"*")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token builtin"}),"input"),"\n\tweight ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," weight ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"-")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"alpha ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"*")," weight_delta",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),"\n\t",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"print"),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token string"}),'"Error:"')," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"+")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token builtin"}),"str"),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"error",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"+")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token string"}),'" Prediction:"')," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"+")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token builtin"}),"str"),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"pred",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),"\n\t",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"print"),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token string"}),'"Delta:"')," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"+")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token builtin"}),"str"),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"delta",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"+")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token string"}),'" Weight Delta:"')," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token operator"}),"+")," ",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token builtin"}),"str"),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"weight_delta",Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),Object(n.mdx)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),"\n"))),Object(n.mdx)("p",null,"Output: "),Object(n.mdx)("div",{className:"gatsby-highlight","data-language":"text"},Object(n.mdx)("pre",Object.assign({parentName:"div"},{className:"language-text"}),Object(n.mdx)("code",Object.assign({parentName:"pre"},{className:"language-text"}),"-----\nWeight:0.0\nError:0.25 Prediction:0.0\nDelta:-0.5 Weight Delta:-2.0\n-----\nWeight:0.2\nError:0.09000000000000002 Prediction:0.8\nDelta:0.30000000000000004 Weight Delta:1.2000000000000002\n-----\nWeight:0.07999999999999999\nError:0.03240000000000002 Prediction:0.31999999999999995\nDelta:-0.18000000000000005 Weight Delta:-0.7200000000000002\n-----\n\n.\n.\n.\n.\nWeight:0.1249647361261568\nError:1.9896652774865827e-08 Prediction:0.4998589445046272\nDelta:-0.00014105549537279938 Weight Delta:-0.0005642219814911975\n-----\nWeight:0.1250211583243059\nError:7.16279499894418e-09 Prediction:0.5000846332972236\nDelta:8.463329722363522e-05 Weight Delta:0.00033853318889454087\n-----\nWeight:0.12498730500541645\nError:2.5786061996210327e-09 Prediction:0.4999492200216658\nDelta:-5.077997833419223e-05 Weight Delta:-0.00020311991333676893\n-----\nWeight:0.12500761699675011\nError:9.282982318601891e-10 Prediction:0.5000304679870005\nDelta:3.046798700045983e-05 Weight Delta:0.00012187194800183931"))),Object(n.mdx)("p",null,"We got to the output, 0.5000304679870005 which is almost equal to 0.5 and the error is almost negligible now. "),Object(n.mdx)("p",null,"So this is basically how gradient descent works under the hood and how machines can learn. In the next blog, we will play with gradient descent a bit more,\nlearn to use it with multiple inputs, outputs, and tweak some aspects of the weights to get better results. "))}o.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-posts-10-02-2021-learning-index-mdx-b81190d2cb678307a0e5.js.map